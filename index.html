<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.10/dist/vue.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="canonical" href="https://krekog.github.io/sparkycalc/" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <style>
      .container-lg {height: 100%;}
    </style>
    <title>SparkyCalc</title>
  </head>
  <body>
    <div id="app"></div>

    <script type="text/javascript">
      const calculator = {
        template: `
          <div class="container-lg">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="lum-pos-tab" data-bs-toggle="tab" data-bs-target="#menu-position" type="button" role="tab" aria-controls="home" aria-selected="true">Position</button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="thickness-tab" data-bs-toggle="tab" data-bs-target="#menu-csa" type="button" role="tab" aria-controls="profile" aria-selected="false">CSA</button>
              </li>
            </ul>

            <div class="tab-content" id="myTabContent">
              <div class="tab-pane fade show active" id="menu-position" role="tabpanel" aria-labelledby="menu-position-tab">
                <div class="container-lg px-4 border bg-light">
                  <h1>Luminaire position calculator</h1>
                  <div class="form-floating">
                    <input id="fullLength" type="number" v-model="fullLength" class="form-control" placeholder="Room length">
                    <label for="fullLength">Room length</label>
                  </div>
                  <div class="form-floating">
                    <input id="numberOfLuminaires" type="number" v-model="numberOfLuminaires" class="form-control" placeholder="Number of Luminaires">
                    <label for="numberOfLuminaires">Number of Luminaires</label>
                  </div>
                  <div class="form-floating">
                    <input id="offsetFromLeft" type="number" v-model="offsetFromLeft" default="0" :disabled="forcedLeft > 0" class="form-control" placeholder="Offset from left">
                    <label for="offseoffsetFromLefttLeft">Offset from left</label>
                  </div>
                  <div class="form-floating">
                    <input id="offsetFromRight" type="number" v-model="offsetFromRight" default="0" :disabled="forcedRight > 0" class="form-control" placeholder="Offset from right">
                    <label for="offsetFromRight">Offset from right</label>
                  </div>
                  <div class="form-floating">
                    <input id="forcedLeft" type="number" v-model="forcedLeft" default="0" :disabled="offsetFromLeft > 0" class="form-control" placeholder="Force position of first from left side">
                    <label for="forcedLeft">Force position of first from left side</label>
                  </div>
                  <div class="form-floating">
                    <input id="forcedRight" type="number" v-model="forcedRight" default="0" :disabled="offsetFromRight > 0" class="form-control" placeholder="Force position of first from right side">
                    <label for="forcedRight">Force position of first from right side</label>
                  </div>
                  <div v-if="numberOfLuminaires && fullLength">
                    <h2>Luminaire positions</h2>
                    <ul class="list-group text-center">
                      <li class="list-group-item">|--<span v-for="distance in distanceList">{{Math.round((distance.distance + Number.EPSILON) * 100) / 100}}<span v-if="distance.index != Object.keys(distanceList).length">--â®¾--</span></span>--|</li>
                    </ul>
                    <div v-if="offsetFromLeft < 1 && offsetFromRight < 1 && !forcedLeft && !forcedRight">
                      <h4>Luminaire positions with laser measuring tool</h4>
                      <ul v-for="position in positions" class="list-group">
                        <li class="list-group-item">{{position.index + 1}}. {{Math.round((position.position + Number.EPSILON) * 100) / 100}}</li>
                      </ul>
                    </div>
                    <div v-else>
                      <div>
                        <h4>Luminaire positions with laser measuring tool from the left</h4>
                        <ul v-for="position in positions" class="list-group">
                          <li class="list-group-item">{{position.index + 1}}. {{Math.round((position.position + Number.EPSILON) * 100) / 100}}</li>
                        </ul>
                      </div>
                      <div>
                        <h4>Luminaire positions with laser measuring tool from the right:</h4>
                        <ul v-for="position in positionsFromTheRight" class="list-group">
                          <li class="list-group-item">{{position.index + 1}}. {{Math.round((position.position + Number.EPSILON) * 100) / 100}}</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <div class="d-none">
                    <h5>Debug panel</h5>
                    <div>
                      <label for="effectiveLength">effective length:</label><br>
                      <input name="effectiveLength" type="text" v-model="effectiveLength" default="0">
                    </div>
                    <div>
                      <label for="luminaireShineRadius">Luminaire shine radius:</label><br>
                      <input name="luminaireShineRadius" type="text" v-model="luminaireShineRadius" default="0">
                    </div>
                  </div>
                </div>
              </div>

              <div class="tab-pane fade" id="menu-csa" role="tabpanel" aria-labelledby="menu-csa-tab">
                <div class="container-lg px-4 border bg-light">
                  <h1><abbr title="Cross-Sectional Area">CSA</abbr> calculator</h1>

                  <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item" role="presentation">
                      <button class="nav-link active" id="pills-diameter-tab" data-bs-toggle="pill" data-bs-target="#diameter" type="button" role="tab" aria-controls="pills-home" aria-selected="true">From diameter</button>
                    </li>
                    <li class="nav-item" role="presentation">
                      <button class="nav-link" id="pills-addition-tab" data-bs-toggle="pill" data-bs-target="#addition" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Addition</button>
                    </li>
                  </ul>
                  <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="diameter" role="tabpanel" aria-labelledby="diameter-tab">
                      <h4>From diameter</h4>
                      <div class="form-floating">
                        <input id="fullLength" type="number" v-model="numberOfStrands" default="1" class="form-control" placeholder="Number of strands">
                        <label for="fullLength">Number of strands</label>
                      </div>
                      <div class="form-floating">
                        <input id="fullLength" type="number" v-model="diameter" class="form-control" placeholder="Strand Diameter in mm">
                        <label for="fullLength">Strand Diameter in mm</label>
                      </div>
                      <div v-if="diameter && numberOfStrands">
                        <h2>Effective CSA:</h2>
                        <ul class="list-group text-center">
                          <li class="list-group-item">{{Math.round(Math.PI * Math.pow((diameter * 1.0) / 2, 2) * numberOfStrands * 1000) / 1000}} mm<sup>2</sup></li>
                        </ul>
                      </div>
                    </div>
                    <div class="tab-pane fade" id="addition" role="tabpanel" aria-labelledby="addition-tab">
                      <h4>Addition</h4>
                      <div class="form-floating">
                        <input id="fullLength" type="number" v-model="firstThickness" class="form-control" placeholder="CSA in mm<sup>2</sup>">
                        <label for="fullLength">CSA in mm<sup>2</sup></label>
                      </div>
                      <div class="form-floating">
                        <input id="fullLength" type="number" v-model="secondThickness" default="1" class="form-control" placeholder="CSA in mm<sup>2</sup>">
                        <label for="fullLength">CSA in mm<sup>2</sup></label>
                      </div>
                      <div v-if="firstThickness && secondThickness">
                        <h2>Effective CSA:</h2>
                        <ul class="list-group text-center">
                          <li class="list-group-item">{{Math.round(Math.sqrt((Math.pow(firstThickness, 2) + Math.pow(secondThickness, 2))) * 1000) / 1000}} mm<sup>2</sup></li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          `,
        data() {
          return {
            fullLength: null,
            numberOfLuminaires: null,
            offsetFromLeft: null,
            offsetFromRight:null,
            forcedLeft:null,
            forcedRight:null,
            diameter:null,
            numberOfStrands:1,
            firstThickness:null,
            secondThickness:null
          }
        },
        computed: {
          effectiveLength: function () {
            if (this.forcedLeft && this.forcedRight) {
                return Math.abs(this.forcedLeft - this.forcedRight)
            } else if (this.forcedLeft && !this.forcedRight) {
                return (this.fullLength - this.forcedLeft - this.offsetFromRight)
            } else if (!this.forcedLeft && this.forcedRight) {
                return (this.fullLength - this.offsetFromLeft - (this.fullLength - this.forcedRight))
            } else {
              return this.fullLength - this.offsetFromLeft - this.offsetFromRight
            }
          },
          luminaireShineRadius: function () {
            if (this.forcedLeft && this.forcedRight) {
                return this.effectiveLength / (this.numberOfLuminaires * 2 - 2)
            }

            if ((this.forcedLeft && !this.forcedRight) || !this.forcedLeft && this.forcedRight) {
                return this.effectiveLength / (this.numberOfLuminaires * 2 - 1)
            }

            return this.effectiveLength / (this.numberOfLuminaires * 2)
          },
          positions: function () {
            var positions = []

            for (var i = 0; i < this.numberOfLuminaires; i++) {

              if (this.forcedLeft) {
                positions.push({
                  index: i,
                  position: Number(this.forcedLeft) + Number(this.luminaireShineRadius) * 2 * i
                })
              } else {
                positions.push({
                  index: i,
                  position: Number(this.offsetFromLeft) + Number(this.luminaireShineRadius) + Number(this.luminaireShineRadius) * 2 * i
                })
              }
            }

            return positions;
          },
          positionsFromTheRight: function() {
            let positionsFromTheRight = []
            let i = 0

            this.positions.slice().reverse().forEach(x => positionsFromTheRight.push({index: i++, position: this.fullLength - x.position}))

            return positionsFromTheRight
          },
          distanceList: function() {
            var distanceList = []

            if (this.forcedLeft) {
              distanceList.push({
                index: 1,
                distance: Number(this.forcedLeft)
              })
            } else {
              distanceList.push({
                index: 1,
                distance: Number(this.luminaireShineRadius) + Number(this.offsetFromLeft)
              })
            }

            for (var i = 0; i < this.numberOfLuminaires - 1; i++) {
              distanceList.push({
                index: i + 2,
                distance: Number(this.luminaireShineRadius) * 2
              })
            }

            if (this.forcedRight) {
              distanceList.push({
                index: Number(this.numberOfLuminaires) + 1,
                distance: Number(this.fullLength - this.forcedRight)
              })
            } else {
              distanceList.push({
                index: Number(this.numberOfLuminaires) + 1,
                distance: Number(this.luminaireShineRadius) + Number(this.offsetFromRight)
              })
            }
            return distanceList;
          }
        }
      };

      const app = {
        template: `
          <div class="vue-app">
            <calculator></calculator>
          </div>
          `,
      };

      // register your components
      Vue.component('calculator', calculator);
      Vue.component('app', app);


      // launch your Vue app
      new Vue({
        el: "#app",
        template: `<app></app>`
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
  </body>
</html>
